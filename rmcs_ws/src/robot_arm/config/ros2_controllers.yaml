# ==========================================
# ROS2 控制器配置
# 用于机械臂的轨迹跟踪和关节状态广播
# ==========================================

controller_manager:
  ros__parameters:
    update_rate: 100           # 控制器更新频率
    use_sim_time: false       # true / false   是/否仿真时间
    
    # 关节状态广播器 - 发布/joint_states话题
    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster
    
    # 机械臂轨迹控制器 - 跟踪关节轨迹
    arm_controller:
      type: joint_trajectory_controller/JointTrajectoryController

# ========== 关节状态广播器配置 ==========
joint_state_broadcaster:
  ros__parameters:
    use_sim_time: false

# ========== 机械臂控制器配置 ==========
arm_controller:
  ros__parameters:
    use_sim_time: false
    
    # 控制的关节列表（必须与URDF中的关节名称一致）
    joints:
      - joint1
      - joint2
      - joint3
      - joint4
    
    # 命令接口：接收的控制命令类型
    command_interfaces:
      - position  # 位置控制
    
    # 状态接口：读取的关节状态类型
    state_interfaces:
      - position  # 关节位置
      - velocity  # 关节速度
    
    # 是否允许部分关节目标（false=必须控制所有关节）
    allow_partial_joints_goal: false
    
    # 开环控制（true = 不等待反馈，适用于仿真）
    open_loop_control: false
    
    # 允许在目标轨迹中进行积分
    allow_integration_in_goal_trajectories: true

    constraints:              #(rad)
      stopped_velocity_tolerance: 0.05  # 速度下限，再低视为停止
      goal_time: 5.0                  # 目标运行时间，超出视为运行失败

      #关节限度调整
      joint1:                   #GO1：close
        trajectory: 0.1        #轨迹跟随容错（rad）
        goal: 0.1              #目标角度容错（rad）
      
      joint2:                   #GO1：open
        trajectory: 0.10        
        goal: 0.10              
      
      joint3:                   #GO1:open
        trajectory: 0.10
        goal: 0.10        
      
      joint4:                   #DJI-2006:open
        trajectory: 0.20
        goal: 0.20              